<!DOCTYPE html>
<html>
    <head>
        <title>Admin Panel</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        #qrcode img { margin-top: 20px; }

        @media print {
            body * { visibility: hidden; }
            #qrcode, #qrcode * { visibility: visible; }
            #qrcode {
                position: absolute;
                left: 50%;
                top: 50%;
                transform: translate(-50%, -50%);
            }
        }
        </style>
    </head>
    <body>

        <h2>Admin Panel</h2>

        <label class="mt-2">Visitor Name</label>
        <input id="visitorName" class="form-control" placeholder="Example: Rachel">

        <label class="mt-3">Generated Visitor Link</label>
        <input id="visitorURL" class="form-control" readonly>

        <button class="btn btn-primary mt-3" onclick="generateURL()">Generate Link</button>
        <button class="btn btn-secondary mt-3" onclick="copyURL()">Copy Link</button>
        <button class="btn btn-warning mt-3" onclick="generateQR()">Generate QR Code</button>
        <button class="btn btn-success mt-3" onclick="downloadQR()">Download QR</button>
        <button class="btn btn-danger mt-3" onclick="window.print()">Print QR</button>

        <div id="qrcode"></div>

        <script>
function getBaseVisitorURL() {
    const url = window.location.origin + window.location.pathname;
    // Remove "admin.html" and replace with "visitor.html"
    return url.replace("admin.html", "visitor.html?name=");
}

function generateURL(){
    const base = getBaseVisitorURL();
    const name = document.getElementById("visitorName").value.trim();
    if (!name) {
        alert("Enter a name first");
        return;
    }
    const finalURL = base + encodeURIComponent(name);
    document.getElementById("visitorURL").value = finalURL;
}

function copyURL(){
    const field = document.getElementById("visitorURL");
    field.select();
    field.setSelectionRange(0, 99999);
    navigator.clipboard.writeText(field.value);
    alert("Link copied");
}

function generateQR(){
    document.getElementById("qrcode").innerHTML = "";
    const link = document.getElementById("visitorURL").value;
    if (!link) {
        alert("Generate a link first");
        return;
    }
    new QRCode(document.getElementById("qrcode"), {
        text: link,
        width: 256,
        height: 256
    });
}

function downloadQR() {
    const img = document.querySelector("#qrcode img");
    if (!img) { alert("Generate a QR first."); return; }
    const link = document.createElement("a");
    link.href = img.src;
    link.download = "qrcode.png";
    link.click();
}
</script>
    </body>
</html>

